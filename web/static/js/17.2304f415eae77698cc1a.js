webpackJsonp([17],{"4cht":function(e,t){},PFZf:function(e,t){},h8tv:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r("Xxa5"),s=r.n(a),n=r("exGp"),i=r.n(n),o=r("Dd8w"),c=r.n(o),l=r("NYxO"),d=r("gyMJ"),u=r("PJh5"),f=r.n(u),p=r("ecGJ"),m={name:"app-edit-area-staff",props:["recordId","ids","dept","date"],data:function(){return{form:{workers:this.ids},workerList:[]}},computed:c()({},Object(l.d)("stateChange",["btnLoading"])),methods:{getFormInfo:function(e,t){var r=this;return i()(s.a.mark(function a(){var n;return s.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,e();case 2:1==(n=a.sent).code?r[t]=n.data||[]:r.$message.error(n.message);case 4:case"end":return a.stop()}},a,r)}))()},saveRecord:function(){var e=this;return i()(s.a.mark(function t(){var r;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(d.b)(c()({id:e.recordId,dept:e.dept,date:e.date},e.form));case 2:1==(r=t.sent).code?e.closePanle():e.$message.error(r.message);case 4:case"end":return t.stop()}},t,e)}))()},submitForm:function(){var e=this;this.$refs.form.validate(function(t){t?e.saveRecord():console.log("error submit!")})},resetForm:function(){this.$refs.form.resetFields()},closePanle:function(){this.$emit("reloadEvent","reload")}},created:function(){var e=this;this.getFormInfo(i()(s.a.mark(function t(){return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",Object(d.E)({id:e.recordId,dept:e.dept,date:e.date}));case 1:case"end":return t.stop()}},t,e)})),"workerList")}},h={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticStyle:{width:"70%"}},[r("el-form",{ref:"form",attrs:{model:e.form,"label-width":"100px",size:"small"}},[r("el-form-item",{attrs:{label:"员工列表"}},[r("el-checkbox-group",{model:{value:e.form.workers,callback:function(t){e.$set(e.form,"workers",t)},expression:"form.workers"}},e._l(e.workerList,function(t,a){return r("el-checkbox",{key:a,attrs:{label:t.value}},[e._v("\r\n                    "+e._s(t.name)+"\r\n                ")])}))],1),e._v(" "),r("el-form-item",[r("el-button",{attrs:{type:"primary",loading:e.btnLoading},on:{click:e.submitForm}},[e._v("提交")]),e._v(" "),r("el-button",{on:{click:e.resetForm}},[e._v("重置")])],1)],1)],1)},staticRenderFns:[]};var v=r("VU/8")(m,h,!1,function(e){r("PFZf")},null,null).exports,b={name:"staff-area-list",data:function(){return{search:{dept:"",start_date:f()().format("YYYY-MM-DD")},list:[],loading:!1,dialog:{editVisible:!1},recordId:"",workerIds:[],pickerOptions:{disabledDate:function(e){return e.getTime()<f()().subtract("days",1)}}}},computed:c()({},Object(l.c)("app",["deptId"]),Object(l.d)("dict",["deptList"])),methods:c()({},Object(l.b)("dict",["createDeptList"]),{initial:function(){""!=this.deptId&&(this.search.dept=this.deptId,this.searchHandle())},recordHandler:function(e,t){this.dialog[t]=!0,this.recordId=e.id,this.workerIds=e.workers.map(function(e){return e.id})},getStaffAreaInfo:function(e){var t=this;return i()(s.a.mark(function r(){var a;return s.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return t.loading=!0,r.next=3,Object(d._19)(c()({},t.search));case 3:1==(a=r.sent).code?(t.list=a.data||[],e&&e()):t.$message.error(a.message),t.loading=!1;case 6:case"end":return r.stop()}},r,t)}))()},searchHandle:function(){this.getStaffAreaInfo()},reloadGetData:function(e){if("reload"==e){for(var t in this.dialog)this.dialog[t]=!1;this.searchHandle()}}}),created:function(){this.initial(),this.getStaffAreaInfo(),this.createDeptList()},components:{AppDialog:p.a,AppEditAreaStaff:v}},g={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("nav",{staticClass:"app-location-wrapper"},[r("el-breadcrumb",{staticClass:"fl",attrs:{separator:"/"}},[r("el-breadcrumb-item",{attrs:{to:{path:"/scheduling"}}},[e._v("排班管理")]),e._v(" "),r("el-breadcrumb-item",[e._v("区域管理")]),e._v(" "),r("el-breadcrumb-item",[e._v("区域编辑")])],1)],1),e._v(" "),r("div",{staticClass:"component-top"},[r("div",{staticClass:"search-title fl"},[e._v("门店：")]),e._v(" "),r("el-select",{staticClass:"fl",staticStyle:{width:"160px","margin-right":"10px"},attrs:{size:"small",placeholder:"门店"},on:{change:e.searchHandle},model:{value:e.search.dept,callback:function(t){e.$set(e.search,"dept",t)},expression:"search.dept"}},e._l(e.deptList,function(e,t){return r("el-option",{key:t,attrs:{label:e.name,value:e.value}})})),e._v(" "),r("div",{staticClass:"search-title fl"},[e._v("日期：")]),e._v(" "),r("el-date-picker",{staticClass:"fl",staticStyle:{width:"180px","margin-right":"10px"},attrs:{size:"small",type:"date",placeholder:"选择日期",format:"yyyy 年 MM 月 dd 日","value-format":"yyyy-MM-dd","picker-options":e.pickerOptions},on:{change:e.searchHandle},model:{value:e.search.start_date,callback:function(t){e.$set(e.search,"start_date",t)},expression:"search.start_date"}})],1),e._v(" "),r("div",{staticClass:"component-main"},[r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{size:"small",data:e.list,stripe:"",border:""}},[r("el-table-column",{attrs:{prop:"name",label:"区域名称",width:"200"}}),e._v(" "),r("el-table-column",{attrs:{label:"员工"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.workers,function(t,a){return r("em",{key:a,style:{color:t.color}},[e._v(e._s(t.name)+",")])})}}])}),e._v(" "),r("el-table-column",{attrs:{label:"操作",width:"90"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(r){r.stopPropagation(),e.recordHandler(t.row,"editVisible")}}},[e._v("\r\n                        编辑\r\n                    ")])]}}])})],1)],1),e._v(" "),r("app-dialog",{attrs:{title:"编辑员工",visible:e.dialog.editVisible},on:{"update:visible":function(t){e.$set(e.dialog,"editVisible",t)}}},[r("app-edit-area-staff",{attrs:{"record-id":e.recordId,ids:e.workerIds,dept:e.search.dept,date:e.search.start_date},on:{reloadEvent:e.reloadGetData}})],1)],1)},staticRenderFns:[]};var _=r("VU/8")(b,g,!1,function(e){r("4cht")},null,null);t.default=_.exports}});