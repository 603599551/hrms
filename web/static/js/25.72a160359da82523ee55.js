webpackJsonp([25],{"5zde":function(e,t,n){n("zQR9"),n("qyJz"),e.exports=n("FeBl").Array.from},DJaI:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n("c/Tr"),r=n.n(a),i=n("Xxa5"),s=n.n(i),l=n("exGp"),o=n.n(l),c=n("Dd8w"),u=n.n(c),d=n("yTUl"),f=n("NYxO"),p=n("jt1B"),h=n("gyMJ"),m={name:"ScrapOrderManager",data:function(){return{list:[],tableList:[],filterText:"",checkedKeys:[],multipleSelection:[],btnLoading:!1}},watch:{filterText:function(e){this.$refs.tree.filter(e)},tableList:function(e,t){e.length?this.setLeaveRemind(!0):this.setLeaveRemind(!1)}},methods:u()({},Object(f.b)(["setLeaveRemind"]),{asyncTableList:function(){var e=this,t=[];Object(p.b)(this.list,function(n){-1!==e.checkedKeys.findIndex(function(e){return e===n.id})&&t.push(n)}),this.tableList=t},checkChangeHandle:function(){this.getCheckedKeys(),this.asyncTableList()},getCheckedKeys:function(){this.checkedKeys=this.$refs.tree.getCheckedKeys(!0)},setCheckedKeys:function(){this.$refs.tree.setCheckedKeys(this.checkedKeys)},filterNode:function(e,t){return!e||-1!==t.label.indexOf(e)},getGoodsTree:function(){var e=this;return o()(s.a.mark(function t(){var n;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Object(h.T)();case 3:1==(n=t.sent).data.code&&(e.list=n.data.tree),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.error(t.t0);case 10:case"end":return t.stop()}},t,e,[[0,7]])}))()},handleSelectionChange:function(e){this.multipleSelection=e},removeItemHandle:function(e){var t=this;if(!Array.isArray(e)&&0==(e=this.multipleSelection.map(function(e){return e.id})).length)return this.$message.warning("请勾选商品名称！");for(var n=function(n){-1!==e.findIndex(function(e){return e===t.checkedKeys[n]})&&t.checkedKeys.splice(n--,1),a=n},a=0;a<this.checkedKeys.length;a++)n(a);var r=function(n){-1!==e.findIndex(function(e){return e===t.tableList[n].id})&&t.tableList.splice(n--,1),a=n};for(a=0;a<this.tableList.length;a++)r(a);this.setCheckedKeys()},nextStepHandle:function(){var e=this;return o()(s.a.mark(function t(){var n,a;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,0!=(n=e.tableList.map(function(e){return{id:e.id,number:e.number}})).length){t.next=4;break}return t.abrupt("return",e.$message.warning("请先编辑商品后再提交！"));case 4:return e.btnLoading=!0,t.next=7,Object(h.j)({list:n});case 7:1==(a=t.sent).data.code&&void 0!==a.data.id?(e.setLeaveRemind(!1),e.$router.push({path:"/storer_manager/scrap_material_order/"+a.data.id}),setTimeout(function(){e.btnLoading=!1},500)):e.$message.error(a.data.message),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(0),console.error(t.t0);case 14:case"end":return t.stop()}},t,e,[[0,11]])}))()},keyUpHandle:function(e){if(e.stopPropagation(),13===e.keyCode&&-1!==e.target.classList.value.search("el-input__inner")){var t=r()(document.querySelectorAll(".goods-table > .el-table__body-wrapper .el-input__inner")),n=t.findIndex(function(t){return t===e.target});if(-1===n)return;t[n=++n%t.length].focus()}return!1}}),created:function(){this.getGoodsTree()},mounted:function(){document.querySelector(".goods-table").addEventListener("keyup",this.keyUpHandle,!1)},destroyed:function(){document.querySelector(".goods-table").removeEventListener("keyup",this.keyUpHandle)},components:{EditNumber:d.a}},b={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"appManager-wrapper"},[n("section",{staticClass:"goods-tree-box"},[n("el-input",{attrs:{placeholder:"输入商品编号/名称","prefix-icon":"el-icon-search"},model:{value:e.filterText,callback:function(t){e.filterText=t},expression:"filterText"}}),e._v(" "),n("el-tree",{ref:"tree",staticClass:"filter-tree",attrs:{"show-checkbox":"",data:e.list,"node-key":"id","default-expand-all":"","expand-on-click-node":!1,"filter-node-method":e.filterNode},on:{check:e.checkChangeHandle}})],1),e._v(" "),n("div",{staticClass:"dayOrder-list-box"},[n("div",{staticClass:"appManager-top"},[n("el-button",{staticClass:"fl",on:{click:function(t){return t.stopPropagation(),e.removeItemHandle(t)}}},[e._v("批量移除")]),e._v(" "),n("ul",{staticClass:"fr"},[n("el-button",{staticClass:"fl",attrs:{type:"primary",loading:e.btnLoading},on:{click:function(t){return t.stopPropagation(),e.nextStepHandle(t)}}},[e._v("下一步")])],1)],1),e._v(" "),n("div",{staticClass:"appManager-list fixedTable-list"},[n("el-table",{staticClass:"goods-table",attrs:{data:e.tableList,border:""},on:{"selection-change":e.handleSelectionChange}},[n("el-table-column",{attrs:{type:"selection",width:"50",fixed:""}}),e._v(" "),n("el-table-column",{attrs:{prop:"name",label:"商品名称",sortable:""}}),e._v(" "),n("el-table-column",{attrs:{prop:"code",label:"商品编码",width:"100"}}),e._v(" "),n("el-table-column",{attrs:{prop:"attribute_2_text",label:"商品规格",width:"100"}}),e._v(" "),n("el-table-column",{attrs:{prop:"unit_text",label:"单位",width:"100"}}),e._v(" "),n("el-table-column",{attrs:{label:"数量",width:"140"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("EditNumber",{attrs:{stepVal:1},model:{value:t.row.number,callback:function(n){e.$set(t.row,"number",e._n(n))},expression:"scope.row.number"}})]}}])}),e._v(" "),n("el-table-column",{attrs:{label:"操作",width:"100",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{type:"text"},on:{click:function(n){n.stopPropagation(),e.removeItemHandle([t.row.id])}}},[n("i",{staticClass:"el-icon-delete"}),e._v(" 移除\r\n                        ")])]}}])})],1)],1)])])},staticRenderFns:[]};var v=n("VU/8")(m,b,!1,function(e){n("aAEx")},null,null);t.default=v.exports},QlLH:function(e,t,n){var a=n("tvvF");"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);n("rjj0")("6ea2d616",a,!0,{})},aAEx:function(e,t,n){var a=n("h/ws");"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);n("rjj0")("5092f990",a,!0,{})},"c/Tr":function(e,t,n){e.exports={default:n("5zde"),__esModule:!0}},fBQ2:function(e,t,n){"use strict";var a=n("evD5"),r=n("X8DO");e.exports=function(e,t,n){t in e?a.f(e,t,r(0,n)):e[t]=n}},"h/ws":function(e,t,n){(e.exports=n("FZ+f")(!1)).push([e.i,".dayOrder-list-box{margin-left:320px}",""])},qyJz:function(e,t,n){"use strict";var a=n("+ZMJ"),r=n("kM2E"),i=n("sB3e"),s=n("msXi"),l=n("Mhyx"),o=n("QRG4"),c=n("fBQ2"),u=n("3fs2");r(r.S+r.F*!n("dY0y")(function(e){Array.from(e)}),"Array",{from:function(e){var t,n,r,d,f=i(e),p="function"==typeof this?this:Array,h=arguments.length,m=h>1?arguments[1]:void 0,b=void 0!==m,v=0,g=u(f);if(b&&(m=a(m,h>2?arguments[2]:void 0,2)),void 0==g||p==Array&&l(g))for(n=new p(t=o(f.length));t>v;v++)c(n,v,b?m(f[v],v):f[v]);else for(d=g.call(f),n=new p;!(r=d.next()).done;v++)c(n,v,b?s(d,m,[r.value,v],!0):r.value);return n.length=v,n}})},tvvF:function(e,t,n){(e.exports=n("FZ+f")(!1)).push([e.i,".input-number-wrapper{display:inline-block;max-width:120px}.input-number-wrapper .el-input-number{width:100%}",""])},yTUl:function(e,t,n){"use strict";var a={name:"EditNumber",props:{value:{type:Number,default:1},ctrlPos:{type:String,default:""},minVal:{type:Number,default:0},maxVal:{type:Number,default:999999},stepVal:{type:Number,default:1},disabled:{type:Boolean,default:!1}},data:function(){return{dataVal:this.value}},computed:{promptMsg:function(){return this.value<0?"请输入数字":this.formatNumber(this.value)}},methods:{formatNumber:function(e){for(var t=(e+="").split("."),n="-"===t[0].charAt(0)?"-":"",a=n?t[0].slice(1):t[0],r="";a.length>3;)r=","+a.slice(-3)+r,a=a.slice(0,a.length-3);return a&&(r=a+r),""+n+r+(t[1]?"."+t[1]:"")},handleInput:function(e,t){var n=this;!isNaN(t)&&/^(0|[1-9][0-9]*)(\.[0-9]*)?$/.test(t)||""===t?(t>this.maxVal&&(t=Number(this.maxVal),this.$nextTick(function(){return e.target.value=t})),this.dataVal=Number(t),this.$emit("change",this.dataVal),this.$emit("input",this.dataVal)):this.$nextTick(function(){return e.target.value=n.dataVal})},handleChange:function(e){this.dataVal=Number(e),this.$emit("change",this.dataVal),this.$emit("input",this.dataVal)}}},r={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-tooltip",{attrs:{content:e.promptMsg,placement:"top"}},[n("div",{staticClass:"input-number-wrapper"},[n("el-input-number",{attrs:{size:"mini",value:e.value,min:e.minVal,max:e.maxVal,step:e.stepVal,"controls-position":e.ctrlPos,disabled:e.disabled},on:{change:e.handleChange},nativeOn:{input:function(t){e.handleInput(t,t.target.value)},click:function(e){e.stopPropagation()}}})],1)])},staticRenderFns:[]};var i=n("VU/8")(a,r,!1,function(e){n("QlLH")},null,null);t.a=i.exports}});
//# sourceMappingURL=25.72a160359da82523ee55.js.map