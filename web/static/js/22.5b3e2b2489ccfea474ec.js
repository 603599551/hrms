webpackJsonp([22],{"MH/f":function(t,e){},WMoI:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("Xxa5"),i=a.n(n),r=a("exGp"),s=a.n(r),c=a("Dd8w"),l=a.n(c),o=a("gyMJ"),u=a("NYxO"),d=a("PJh5"),f=a.n(d),m=a("+xrz"),p={name:"app-turnover-list",data:function(){return{weekDay:null,form:{date:""},list:[],tableHeaders:[],timePart:["8:00 - 9:00","9:00 - 10:00","10:00 - 11:00","11:00 - 12:00","12:00 - 13:00","13:00 - 14:00","14:00 - 15:00","15:00 - 16:00","16:00 - 17:00","17:00 - 18:00","18:00 - 19:00","19:00 - 20:00","20:00 - 21:00","21:00 - 22:00"],pickerOptions:{firstDayOfWeek:1,disabledDate:function(t){return t.getTime()<f()().subtract(1,"days")},shortcuts:[{text:"本周",onClick:function(t){t.$emit("pick",new Date)}},{text:"下一周",onClick:function(t){var e=new Date;e.setTime(e.getTime()+6048e5),t.$emit("pick",e)}}]}}},computed:l()({},Object(u.d)("dict",["weekList"]),Object(u.d)("stateChange",["btnLoading"]),{dayList:function(){return this.weekList.map(function(t){return t.name})}}),methods:{dateChangeHandle:function(t){if(t){var e=f()(t).format("E"),a=f()(t).subtract(Number(e)-1,"days");this.setDateHandler(a)}},initialTHead:function(){this.tableHeaders=_.cloneDeep(this.dayList)},initialWeek:function(){this.dateChangeHandle(new Date)},initialListHandle:function(){var t=this;this.timePart.forEach(function(){var e=[];t.dayList.forEach(function(){return e.push({input:""})}),t.list.push(e)})},setDateHandler:function(t){this.weekDay=t.toDate(),this.form.date=t.format("MM-DD");for(var e=0;e<this.dayList.length;e++)this.$set(this.tableHeaders,e,this.dayList[e]+" "+f()(new Date(t).getTime()+864e5*e).format("MM-DD"))},getTurnoverList:function(){var t=this;return s()(i.a.mark(function e(){var a,n,r;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(o.L)();case 2:1==(a=e.sent).code?(n=t.getArrayTotal(a.data),r=t.getArrayTotal(t.list),n!==r?t.$message.error("数据有误！"):t.list=a.data):t.$message.error(a.message);case 4:case"end":return e.stop()}},e,t)}))()},saveHandle:function(){var t=this;return s()(i.a.mark(function e(){var a;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.weekDay){e.next=2;break}return e.abrupt("return",t.$message.warning("请选择周，再进行提交！"));case 2:return e.next=4,Object(o.d)({date:t.form.date,list:t.list});case 4:1==(a=e.sent).code?t.$message.success(a.message):t.$message.error(a.message);case 6:case"end":return e.stop()}},e,t)}))()},getArrayTotal:function(t){return t.reduce(function(t,e){return Array.isArray(t)&&(t=t.length),t+e.length})}},created:function(){this.initialTHead(),this.initialWeek(),this.initialListHandle(),this.getTurnoverList()},mounted:function(){new m.a({tbodyWrapper:this.$refs.table.children[1],exceptCellIndexs:[0],callback:function(t,e){}}).install()}},h={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("nav",{staticClass:"app-location-wrapper"},[a("el-breadcrumb",{staticClass:"fl",attrs:{separator:"/"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/scheduling"}}},[t._v("排班管理")]),t._v(" "),a("el-breadcrumb-item",[t._v("排班管理")]),t._v(" "),a("el-breadcrumb-item",[t._v("预估营业额")])],1),t._v(" "),t._m(0)],1),t._v(" "),a("div",{staticClass:"component-top"},[a("div",{staticClass:"search-title fl"},[t._v("选择周：")]),t._v(" "),a("el-date-picker",{staticClass:"fl",attrs:{size:"small",type:"week",format:"yyyy 第 WW 周",placeholder:"选择周",clearable:!1,"picker-options":t.pickerOptions},on:{change:t.dateChangeHandle},model:{value:t.weekDay,callback:function(e){t.weekDay=e},expression:"weekDay"}}),t._v(" "),a("el-button",{staticClass:"fr",attrs:{size:"small",icon:"el-icon-plus",type:"primary",loading:t.btnLoading},on:{click:t.saveHandle}},[t._v("保存")])],1),t._v(" "),a("div",{staticClass:"component-main"},[a("table",{ref:"table",staticClass:"turnover-list"},[a("thead",[a("tr",[a("th",[t._v("时间段")]),t._v(" "),t._l(t.tableHeaders,function(e,n){return a("th",{key:n},[t._v(t._s(e))])})],2)]),t._v(" "),a("tbody",t._l(t.list,function(e,n){return a("tr",{key:n},[a("td",[t._v(t._s(t.timePart[n]))]),t._v(" "),t._l(e,function(e,i){return a("td",{key:i,attrs:{"data-index":n+","+i}},[a("el-input",{attrs:{type:"number",size:"mini"},model:{value:e.input,callback:function(a){t.$set(e,"input",a)},expression:"item2.input"}})],1)})],2)}))])])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"message-prompt fr"},[e("i",{staticClass:"el-icon-info"}),this._v("在列表中输入每个时间段的预估营业额")])}]};var v=a("VU/8")(p,h,!1,function(t){a("MH/f")},null,null);e.default=v.exports}});