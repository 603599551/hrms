webpackJsonp([13],{"2dpe":function(e,t,a){var r=a("nuJ3");"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);a("rjj0")("79e8ae36",r,!0,{})},"5zde":function(e,t,a){a("zQR9"),a("qyJz"),e.exports=a("FeBl").Array.from},"6Gt1":function(e,t,a){(e.exports=a("FZ+f")(!1)).push([e.i,"",""])},OjRn:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("Xxa5"),n=a.n(r),s=a("exGp"),i=a.n(s),o=a("rpul"),l=a("c/Tr"),c=a.n(l),p=a("Dd8w"),d=a.n(p),u=a("yTUl"),m=a("NYxO"),f=a("gyMJ"),h={name:"ShowScrapOrderPanel",props:{params:Object},data:function(){return{list:[],referData:[],loading:!1}},watch:{list:{handler:function(e,t){_.isEqual(e,this.referData)?this.setLeaveRemind(!1):this.setLeaveRemind(!0)},deep:!0}},methods:d()({},Object(m.b)(["setLeaveRemind"]),{getReceiveOrderInfo:function(){var e=this;return i()(n.a.mark(function t(){var a;return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,e.loading=!0,a=null,"store"!==e.params.menuType){t.next=9;break}return t.next=6,Object(f.E)({id:e.params.id});case 6:a=t.sent,t.next=13;break;case 9:if("logistic"!==e.params.menuType){t.next=13;break}return t.next=12,Object(f.X)({id:e.params.id});case 12:a=t.sent;case 13:a&&1==a.data.code&&(e.list=a.data.list,e.referData=_.cloneDeep(e.list)),t.next=19;break;case 16:t.prev=16,t.t0=t.catch(0),console.error(t.t0);case 19:e.loading=!1;case 20:case"end":return t.stop()}},t,e,[[0,16]])}))()},orderHandler:function(e,t){var a=this;return i()(n.a.mark(function r(){var s;return n.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(r.prev=0,s=null,"save"!==e){r.next=8;break}return r.next=5,Object(f._59)({id:a.params.id,list:a.list.map(function(e){return{id:e.id,store_scrap_material_id:e.store_scrap_material_id,number:e.number}})});case 5:s=r.sent,r.next=12;break;case 8:if("receive"!==e){r.next=12;break}return r.next=11,Object(f._53)({id:a.params.id});case 11:s=r.sent;case 12:if("store"!==a.params.menuType||"close"!==e){r.next=18;break}return r.next=15,Object(f.e)({id:a.params.id});case 15:s=r.sent,r.next=22;break;case 18:if("logistic"!==a.params.menuType||"close"!==e){r.next=22;break}return r.next=21,Object(f.d)({id:a.params.id});case 21:s=r.sent;case 22:s&&1==s.data.code?(a.$message.success(s.data.message),t&&t()):a.$message.error(s.data.message),r.next=28;break;case 25:r.prev=25,r.t0=r.catch(0),console.error(r.t0);case 28:case"end":return r.stop()}},r,a,[[0,25]])}))()},submitHandle:function(e){var t=this;this.orderHandler(e,function(){t.closePanelHandle()})},closePanelHandle:function(){this.setLeaveRemind(!1),this.params.isPlay=!1},keyUpHandle:function(e){if(e.stopPropagation(),13===e.keyCode&&-1!==e.target.classList.value.search("el-input__inner")){var t=c()(document.querySelectorAll(".scrap-order-panel > .el-table__body-wrapper .el-input__inner")),a=t.findIndex(function(t){return t===e.target});if(-1===a)return;t[a=++a%t.length].focus()}return!1}}),created:function(){this.getReceiveOrderInfo()},mounted:function(){document.querySelector(".scrap-order-panel").addEventListener("keyup",this.keyUpHandle,!1)},destroyed:function(){document.querySelector(".scrap-order-panel").removeEventListener("keyup",this.keyUpHandle)},components:{EditNumber:u.a}},v={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"out-order-panel"},[a("div",{staticClass:"tr"},["store"===e.params.menuType?a("el-button",{attrs:{type:"primary",disabled:!e.params.isEdit},on:{click:function(t){t.stopPropagation(),e.submitHandle("save")}}},[e._v("保存")]):e._e(),e._v(" "),"logistic"===e.params.menuType?a("el-button",{attrs:{type:"primary",disabled:!e.params.isEdit},on:{click:function(t){t.stopPropagation(),e.submitHandle("receive")}}},[e._v("接收")]):e._e(),e._v(" "),a("el-button",{attrs:{type:"primary",disabled:!e.params.isEdit},on:{click:function(t){t.stopPropagation(),e.submitHandle("close")}}},[e._v("关闭订单")])],1),e._v(" "),a("div",{staticStyle:{padding:"20px 0"}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"scrap-order-panel",attrs:{data:e.list,border:""}},[a("el-table-column",{attrs:{prop:"name",label:"原材料名称"}}),e._v(" "),a("el-table-column",{attrs:{prop:"code",label:"原材料编码"}}),e._v(" "),a("el-table-column",{attrs:{prop:"unit_text",label:"单位"}}),e._v(" "),a("el-table-column",{attrs:{prop:"stock",label:"库存数量"}}),e._v(" "),a("el-table-column",{attrs:{label:"废弃数量",width:"140"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("EditNumber",{attrs:{maxVal:t.row.stock,stepVal:1,disabled:!e.params.isEdit},model:{value:t.row.number,callback:function(a){e.$set(t.row,"number",e._n(a))},expression:"scope.row.number"}})]}}])})],1)],1),e._v(" "),a("div",{staticClass:"app-form-item tr"},[a("el-button",{on:{click:function(t){return t.stopPropagation(),e.closePanelHandle(t)}}},[e._v("退出")])],1)])},staticRenderFns:[]};var x=a("VU/8")(h,v,!1,function(e){a("y14Z")},null,null).exports,b={name:"ScrapOrderListManager",data:function(){return{list:[],storeList:[],stateList:[],curPageIndex:1,search:{returnDate:[],store:"",state:"",orderCode:""},loading:!1,showOrderExtract:{isPlay:!1}}},props:{menuType:{type:String,default:""}},methods:{showItemHandle:function(e,t){this.showOrderExtract.isPlay=!0,this.showOrderExtract.id=e,this.showOrderExtract.menuType=this.menuType,this.showOrderExtract.isEdit=t},getStoreList:function(){var e=this;return i()(n.a.mark(function t(){var a;return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Object(f._35)();case 3:1==(a=t.sent).data.code?e.storeList=a.data.list:e.$message.error(a.data.message),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.error(t.t0);case 10:case"end":return t.stop()}},t,e,[[0,7]])}))()},getStateList:function(){var e=this;return i()(n.a.mark(function t(){var a;return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Object(f._31)();case 3:1==(a=t.sent).data.code?e.stateList=a.data.list:e.$message.error(a.data.message),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.error(t.t0);case 10:case"end":return t.stop()}},t,e,[[0,7]])}))()},getOrderList:function(e,t){var a=this;return i()(n.a.mark(function r(){var s,i;return n.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(e=e>0?Number(e):a.curPageIndex,r.prev=1,a.loading=!0,s={pageNum:e,pageSize:10,returnDate:a.search.returnDate,storeId:a.search.store,state:a.search.state,orderCode:a.search.orderCode},i=null,"store"!==a.menuType){r.next=11;break}return r.next=8,Object(f._30)(s);case 8:i=r.sent,r.next=15;break;case 11:if("logistic"!==a.menuType){r.next=15;break}return r.next=14,Object(f.Y)(s);case 14:i=r.sent;case 15:i&&1==i.data.code?(a.list=i.data.data.list,a.list.total=i.data.data.totalRow):a.list.total=0,t&&t(),r.next=22;break;case 19:r.prev=19,r.t0=r.catch(1),console.error(r.t0);case 22:a.loading=!1;case 23:case"end":return r.stop()}},r,a,[[1,19]])}))()},stopItemHandle:function(e){var t=this;this.$confirm("确认取消此废弃单吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(i()(n.a.mark(function a(){var r;return n.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(a.prev=0,r=null,"store"!==t.menuType){a.next=8;break}return a.next=5,Object(f.e)({id:e.id});case 5:r=a.sent,a.next=12;break;case 8:if("logistic"!==t.menuType){a.next=12;break}return a.next=11,Object(f.d)({id:e.id});case 11:r=a.sent;case 12:r&&1==r.data.code?(t.getOrderList(t.curPageIndex),t.$message.success(r.data.message)):t.$message.error(r.data.message),a.next=18;break;case 15:a.prev=15,a.t0=a.catch(0),console.error(a.t0);case 18:case"end":return a.stop()}},a,t,[[0,15]])}))).catch(function(){})},handleCurrentChange:function(e){this.curPageIndex=e,this.getOrderList(e)},searchHandle:function(){this.getOrderList(1)}},created:function(){this.getStoreList(),this.getStateList(),this.getOrderList(this.curPageIndex)},components:{ExtractPanel:o.a,ShowScrapOrderPanel:x}},g={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"appManager-wrapper"},[a("div",{staticClass:"appManager-top"},[a("strong",{staticClass:"promptText fl"},[e._v("废弃日期：")]),e._v(" "),a("el-date-picker",{staticClass:"fl",staticStyle:{width:"200px"},attrs:{type:"date",placeholder:"废弃日期",format:"yyyy 年 MM 月 dd 日","value-format":"yyyy-MM-dd"},on:{change:e.searchHandle},model:{value:e.search.returnDate,callback:function(t){e.$set(e.search,"returnDate",t)},expression:"search.returnDate"}}),e._v(" "),"logistic"===e.menuType?a("el-select",{staticClass:"fl",staticStyle:{width:"180px","margin-left":"10px"},attrs:{clearable:"",placeholder:"选择门店"},on:{change:e.searchHandle},model:{value:e.search.store,callback:function(t){e.$set(e.search,"store",t)},expression:"search.store"}},e._l(e.storeList,function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.id}})})):e._e(),e._v(" "),a("el-select",{staticClass:"fl",staticStyle:{width:"150px","margin-left":"10px"},attrs:{placeholder:"选择状态"},on:{change:e.searchHandle},model:{value:e.search.state,callback:function(t){e.$set(e.search,"state",t)},expression:"search.state"}},e._l(e.stateList,function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.value}})})),e._v(" "),a("el-input",{staticClass:"fr",staticStyle:{width:"220px"},attrs:{placeholder:"请输入废弃单号","prefix-icon":"el-icon-search",clearable:""},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.searchHandle(t):null}},model:{value:e.search.orderCode,callback:function(t){e.$set(e.search,"orderCode",t)},expression:"search.orderCode"}})],1),e._v(" "),a("div",{staticClass:"appManager-list"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.list,border:""}},[a("el-table-column",{attrs:{prop:"order_number",label:"废弃单号",sortable:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"create_time",label:"废弃时间",sortable:""}}),e._v(" "),a("el-table-column",{attrs:{label:"状态",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{type:t.row.status_color,size:"medium"}},[e._v(e._s(t.row.status_text))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){a.stopPropagation(),e.showItemHandle(t.row.id,t.row.isEdit)}}},[a("i",{staticClass:"el-icon-view"}),e._v(" 查看\r\n                    ")]),e._v(" "),a("el-button",{attrs:{disabled:!t.row.isEdit,type:"text"},on:{click:function(a){a.stopPropagation(),e.stopItemHandle(t.row)}}},[a("i",{staticClass:"el-icon-delete"}),e._v(" 关闭\r\n                    ")])]}}])})],1),e._v(" "),a("el-pagination",{attrs:{background:"",layout:"prev, pager, next, jumper",total:e.list.total},on:{"current-change":e.handleCurrentChange}})],1),e._v(" "),a("ExtractPanel",{attrs:{params:e.showOrderExtract}},[a("span",{attrs:{slot:"title"},slot:"title"},[e._v("废弃单详情")]),e._v(" "),a("ShowScrapOrderPanel",{attrs:{slot:"panel",params:e.showOrderExtract},slot:"panel"})],1)],1)},staticRenderFns:[]};var y=a("VU/8")(b,g,!1,function(e){a("rcvl")},null,null);t.default=y.exports},QlLH:function(e,t,a){var r=a("tvvF");"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);a("rjj0")("6ea2d616",r,!0,{})},"c/Tr":function(e,t,a){e.exports={default:a("5zde"),__esModule:!0}},fBQ2:function(e,t,a){"use strict";var r=a("evD5"),n=a("X8DO");e.exports=function(e,t,a){t in e?r.f(e,t,n(0,a)):e[t]=a}},kEiT:function(e,t,a){(e.exports=a("FZ+f")(!1)).push([e.i,".out-order-panel{padding:20px;overflow:hidden}",""])},nuJ3:function(e,t,a){(e.exports=a("FZ+f")(!1)).push([e.i,".extract-masker{position:fixed;width:100%;height:100%;left:0;top:0;background:rgba(0,0,0,.2);z-index:8}.extract-wrapper{width:50%;height:calc(100% - 50px);position:fixed;top:50px;right:0;bottom:0;background:#f5f5f5;-webkit-transform:translateZ(0);transform:translateZ(0);-webkit-box-shadow:-3px 0 4px rgba(0,0,0,.1);box-shadow:-3px 0 4px rgba(0,0,0,.1);z-index:9}.extract-top{height:50px;border-bottom:1px solid #ccc;position:relative}.extract-top .title{line-height:50px;padding-left:15px;font-size:16px;font-weight:700;width:80%}.extract-top .extract-close{position:absolute;right:12px;top:10px;font-size:22px;padding:5px;cursor:pointer;-webkit-transition:all .3s ease;transition:all .3s ease}.extract-top .extract-close:hover{-webkit-transform:rotate(90deg);transform:rotate(90deg)}.extract-main{height:calc(100% - 51px);overflow-y:auto}.extract-main .no-info{text-align:center;padding-top:50px}#app .app-side-enter,#app .app-side-leave-to{opacity:0;-webkit-transform:translate3d(100%,0,0);transform:translate3d(100%,0,0)}#app .app-side-enter-to,#app .app-side-leave{opacity:1;-webkit-transform:translateZ(0);transform:translateZ(0)}#app .app-side-enter-active,#app .app-side-leave-active{-webkit-transition:all .5s ease-in-out;transition:all .5s ease-in-out}",""])},qyJz:function(e,t,a){"use strict";var r=a("+ZMJ"),n=a("kM2E"),s=a("sB3e"),i=a("msXi"),o=a("Mhyx"),l=a("QRG4"),c=a("fBQ2"),p=a("3fs2");n(n.S+n.F*!a("dY0y")(function(e){Array.from(e)}),"Array",{from:function(e){var t,a,n,d,u=s(e),m="function"==typeof this?this:Array,f=arguments.length,h=f>1?arguments[1]:void 0,v=void 0!==h,x=0,b=p(u);if(v&&(h=r(h,f>2?arguments[2]:void 0,2)),void 0==b||m==Array&&o(b))for(a=new m(t=l(u.length));t>x;x++)c(a,x,v?h(u[x],x):u[x]);else for(d=b.call(u),a=new m;!(n=d.next()).done;x++)c(a,x,v?i(d,h,[n.value,x],!0):n.value);return a.length=x,a}})},rcvl:function(e,t,a){var r=a("6Gt1");"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);a("rjj0")("fa45944c",r,!0,{})},rpul:function(e,t,a){"use strict";var r={name:"ExtractPanel",data:function(){return{}},props:{params:{type:Object,default:function(){return{isPlay:!1}}},width:{type:String,default:"50%"},top:{type:String,default:"50px"}},methods:{handleClick:function(){this.params.isPlay=!1},eventHandle:function(e){e.stopPropagation(),this.params.isPlay&&(this.params.isPlay=!1)}},computed:{computHeight:function(){return-1==this.top.search("px")&&(this.top+="px"),"calc(100% - "+this.top+")"}},mounted:function(){document.getElementById("main").addEventListener("click",this.eventHandle,!1)},destroyed:function(){document.getElementById("main").removeEventListener("click",this.eventHandle)}},n={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("transition",{attrs:{name:"app-side"}},[e.params.isPlay?a("div",{staticClass:"extract-wrapper",style:{width:e.width,top:e.top,height:e.computHeight},on:{click:function(e){e.stopPropagation()}}},[a("div",{staticClass:"extract-top"},[a("h5",{staticClass:"title"},[e._t("title",[e._v("提示信息")])],2),e._v(" "),a("span",{staticClass:"extract-close",on:{click:function(t){return t.stopPropagation(),e.handleClick(t)}}},[a("i",{staticClass:"el-icon-close"})])]),e._v(" "),a("div",{staticClass:"extract-main"},[e._t("panel",[a("div",{staticClass:"no-info"},[e._v("暂无数据...")])])],2)]):e._e()])},staticRenderFns:[]};var s=a("VU/8")(r,n,!1,function(e){a("2dpe")},null,null);t.a=s.exports},tvvF:function(e,t,a){(e.exports=a("FZ+f")(!1)).push([e.i,".input-number-wrapper{display:inline-block;max-width:120px}.input-number-wrapper .el-input-number{width:100%}",""])},y14Z:function(e,t,a){var r=a("kEiT");"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);a("rjj0")("a7106712",r,!0,{})},yTUl:function(e,t,a){"use strict";var r={name:"EditNumber",props:{value:{type:Number,default:1},ctrlPos:{type:String,default:""},minVal:{type:Number,default:0},maxVal:{type:Number,default:999999},stepVal:{type:Number,default:1},disabled:{type:Boolean,default:!1}},data:function(){return{dataVal:this.value}},computed:{promptMsg:function(){return this.value<0?"请输入数字":this.formatNumber(this.value)}},methods:{formatNumber:function(e){for(var t=(e+="").split("."),a="-"===t[0].charAt(0)?"-":"",r=a?t[0].slice(1):t[0],n="";r.length>3;)n=","+r.slice(-3)+n,r=r.slice(0,r.length-3);return r&&(n=r+n),""+a+n+(t[1]?"."+t[1]:"")},handleInput:function(e,t){var a=this;!isNaN(t)&&/^(0|[1-9][0-9]*)(\.[0-9]*)?$/.test(t)||""===t?(t>this.maxVal&&(t=Number(this.maxVal),this.$nextTick(function(){return e.target.value=t})),this.dataVal=Number(t),this.$emit("change",this.dataVal),this.$emit("input",this.dataVal)):this.$nextTick(function(){return e.target.value=a.dataVal})},handleChange:function(e){this.dataVal=Number(e),this.$emit("change",this.dataVal),this.$emit("input",this.dataVal)}}},n={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-tooltip",{attrs:{content:e.promptMsg,placement:"top"}},[a("div",{staticClass:"input-number-wrapper"},[a("el-input-number",{attrs:{size:"mini",value:e.value,min:e.minVal,max:e.maxVal,step:e.stepVal,"controls-position":e.ctrlPos,disabled:e.disabled},on:{change:e.handleChange},nativeOn:{input:function(t){e.handleInput(t,t.target.value)},click:function(e){e.stopPropagation()}}})],1)])},staticRenderFns:[]};var s=a("VU/8")(r,n,!1,function(e){a("QlLH")},null,null);t.a=s.exports}});
//# sourceMappingURL=13.c19fc950631c06c1917a.js.map