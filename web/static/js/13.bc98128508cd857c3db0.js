webpackJsonp([13],{"+xrz":function(e,t,n){"use strict";var r=n("c/Tr"),a=n.n(r),i=n("Zrlr"),s=n.n(i),l=n("wxAW"),o=n.n(l),c=function(){function e(t){if(s()(this,e),this.setParams(t),!this.wrapper)throw new Error("组件参数有误！")}return o()(e,[{key:"setParams",value:function(e){this.wrapper=e.tbodyWrapper||this.wrapper||null,this.exceptIndexs=e.exceptCellIndexs||this.exceptIndexs||[],this.callback=e.callback||this.callback||null,this.currentNode=this.currentNode||null}},{key:"install",value:function(){this.bindEvent()}},{key:"bindEvent",value:function(){this.wrapper.addEventListener("mouseover",this.enterFunc.bind(this),!1),this.wrapper.addEventListener("mouseleave",this.leaveFunc.bind(this),!1)}},{key:"leaveFunc",value:function(){this.setCellStyle(-1),this.currentNode=null}},{key:"enterFunc",value:function(e){e.stopPropagation();var t=this.findParent(e.target,"td");if(t!=this.currentNode){this.currentNode=t;var n=this.findIndex(t.parentNode.children,t);this.setCellStyle(n),this.callback&&this.callback(this.findIndex(this.wrapper.children,t.parentNode),n)}}},{key:"setCellStyle",value:function(e){for(var t=this.wrapper.children,n=0,r=t.length;n<r;n++){for(var a=0,i=t[n].children.length;a<i;a++)t[n].children[a].classList.remove("ctd");-1!==e&&-1===this.exceptIndexs.indexOf(e)&&t[n].children[e].classList.add("ctd")}}},{key:"findParent",value:function(e,t){for(;e&&e!=document;){if(e.tagName.toLowerCase()===t)return e;e=e.parentNode}return null}},{key:"findIndex",value:function(e,t){return a()(e).findIndex(function(e){return e===t})}},{key:"updata",value:function(e){this.setParams(e)}},{key:"remove",value:function(){for(var e in this.wrapper.removeEventListener("mouseover",this.enterFunc,!1),this.wrapper.removeEventListener("mouseleave",this.leaveFunc,!1),this)this[e]=null}}]),e}();t.a=c},"1dwJ":function(e,t,n){(e.exports=n("FZ+f")(!1)).push([e.i,".turnover-list{width:100%;border:1px solid #dcdfe6;border-collapse:collapse;border-spacing:0;margin-bottom:10px}.turnover-list thead th{padding:10px 0;border:1px solid #dcdfe6;background-color:#f5f7fa}.turnover-list thead th:not(:first-of-type){width:13%}.turnover-list tbody td{height:32px;padding:5px;vertical-align:middle;border:1px solid #dcdfe6}.turnover-list tbody>tr:hover,.turnover-list tbody>tr>td.ctd{background-color:#f5f7fa}",""])},KAJA:function(e,t,n){var r=n("1dwJ");"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);n("rjj0")("2d69ddae",r,!0,{})},WMoI:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("Xxa5"),a=n.n(r),i=n("exGp"),s=n.n(i),l=n("Dd8w"),o=n.n(l),c=n("gyMJ"),u=n("NYxO"),d=n("PJh5"),f=n.n(d),p=n("+xrz"),h={name:"app-turnover-list",data:function(){return{weekDay:null,form:{date:""},list:[],tableHeaders:[],timePart:["8:00 - 9:00","9:00 - 10:00","10:00 - 11:00","11:00 - 12:00","12:00 - 13:00","13:00 - 14:00","14:00 - 15:00","15:00 - 16:00","16:00 - 17:00","17:00 - 18:00","18:00 - 19:00","19:00 - 20:00","20:00 - 21:00","21:00 - 22:00"],pickerOptions:{firstDayOfWeek:1,disabledDate:function(e){return e.getTime()<f()().subtract(1,"days")},shortcuts:[{text:"本周",onClick:function(e){e.$emit("pick",new Date)}},{text:"下一周",onClick:function(e){var t=new Date;t.setTime(t.getTime()+6048e5),e.$emit("pick",t)}}]}}},computed:o()({},Object(u.c)("dict",["weekList"]),Object(u.c)("stateChange",["btnLoading"]),{dayList:function(){return this.weekList.map(function(e){return e.name})}}),methods:{dateChangeHandle:function(e){if(e){for(var t=f()(e).format("E"),n=f()(e).subtract(Number(t)-1,"days"),r=0;r<this.dayList.length;r++)this.$set(this.tableHeaders,r,this.dayList[r]+" "+f()(new Date(n).getTime()+864e5*r).format("MM-DD"));this.form.date=n.format("MM-DD")}},initialTHead:function(){this.tableHeaders=_.cloneDeep(this.dayList)},initialListHandle:function(){var e=this;this.timePart.forEach(function(){var t=[];e.dayList.forEach(function(){return t.push({input:""})}),e.list.push(t)})},getTurnoverList:function(){var e=this;return s()(a.a.mark(function t(){var n,r,i;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(c.C)();case 2:1==(n=t.sent).code?(r=e.getArrayTotal(n.data),i=e.getArrayTotal(e.list),r!==i?e.$message.error("数据有误！"):e.list=n.data):e.$message.error(n.message);case 4:case"end":return t.stop()}},t,e)}))()},saveHandle:function(){var e=this;return s()(a.a.mark(function t(){var n;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.weekDay){t.next=2;break}return t.abrupt("return",e.$message.warning("请选择周，再进行提交！"));case 2:return t.next=4,Object(c.b)({date:e.form.date,list:e.list});case 4:1==(n=t.sent).code?e.$message.success(n.message):e.$message.error(n.message);case 6:case"end":return t.stop()}},t,e)}))()},getArrayTotal:function(e){return e.reduce(function(e,t){return Array.isArray(e)&&(e=e.length),e+t.length})}},created:function(){this.initialTHead(),this.initialListHandle(),this.getTurnoverList()},mounted:function(){new p.a({tbodyWrapper:this.$refs.table.children[1],exceptCellIndexs:[0],callback:function(e,t){}}).install()}},v={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("nav",{staticClass:"app-location-wrapper"},[n("el-breadcrumb",{staticClass:"fl",attrs:{separator:"/"}},[n("el-breadcrumb-item",{attrs:{to:{path:"/scheduling"}}},[e._v("排班管理")]),e._v(" "),n("el-breadcrumb-item",[e._v("排班管理")]),e._v(" "),n("el-breadcrumb-item",[e._v("预估营业额")])],1),e._v(" "),e._m(0)],1),e._v(" "),n("div",{staticClass:"component-top"},[n("div",{staticClass:"search-title fl"},[e._v("选择周：")]),e._v(" "),n("el-date-picker",{staticClass:"fl",attrs:{size:"small",type:"week",format:"yyyy 第 WW 周",placeholder:"选择周",clearable:!1,"picker-options":e.pickerOptions},on:{change:e.dateChangeHandle},model:{value:e.weekDay,callback:function(t){e.weekDay=t},expression:"weekDay"}}),e._v(" "),n("el-button",{staticClass:"fr",attrs:{size:"small",icon:"el-icon-plus",type:"primary",loading:e.btnLoading},on:{click:e.saveHandle}},[e._v("保存")])],1),e._v(" "),n("div",{staticClass:"component-main"},[n("table",{ref:"table",staticClass:"turnover-list"},[n("thead",[n("tr",[n("th",[e._v("时间段")]),e._v(" "),e._l(e.tableHeaders,function(t,r){return n("th",{key:r},[e._v(e._s(t))])})],2)]),e._v(" "),n("tbody",e._l(e.list,function(t,r){return n("tr",{key:r},[n("td",[e._v(e._s(e.timePart[r]))]),e._v(" "),e._l(t,function(t,a){return n("td",{key:a,attrs:{"data-index":r+","+a}},[n("el-input",{attrs:{type:"number",size:"mini"},model:{value:t.input,callback:function(n){e.$set(t,"input",n)},expression:"item2.input"}})],1)})],2)}))])])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"message-prompt fr"},[t("i",{staticClass:"el-icon-info"}),this._v("在列表中输入每个时间段的预估营业额")])}]};var m=n("VU/8")(h,v,!1,function(e){n("KAJA")},null,null);t.default=m.exports},Zrlr:function(e,t,n){"use strict";t.__esModule=!0,t.default=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},wxAW:function(e,t,n){"use strict";t.__esModule=!0;var r,a=n("C4MV"),i=(r=a)&&r.__esModule?r:{default:r};t.default=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),(0,i.default)(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}()}});
//# sourceMappingURL=13.bc98128508cd857c3db0.js.map